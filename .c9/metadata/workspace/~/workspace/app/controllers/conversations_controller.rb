{"changed":true,"filter":false,"title":"conversations_controller.rb","tooltip":"~/workspace/app/controllers/conversations_controller.rb","value":"class ConversationsController < ApplicationController\n  before_action :authorize\n \n  layout false\n \n  def create\n    if Conversation.between(params[:sender_id],params[:recipient_id]).present?\n      @conversation = Conversation.between(params[:sender_id],params[:recipient_id]).first\n    else\n      @conversation = Conversation.create!(conversation_params)\n    end\n \n    render json: { conversation_id: @conversation.id }\n  end\n \n  def show\n    @conversation = Conversation.find(params[:id])\n    @reciever = interlocutor(@conversation)\n    @messages = @conversation.messages\n    @message = Message.new\n  end\n \n  private\n  def conversation_params\n    params.permit(:sender_id, :recipient_id)\n  end\n \n  def interlocutor(conversation)\n    @user == conversation.recipient ? conversation.sender : conversation.recipient\n  end\nend","undoManager":{"mark":0,"position":-1,"stack":[]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":0,"column":0},"end":{"row":0,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1429165924000}